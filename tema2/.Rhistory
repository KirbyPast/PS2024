for(i in x){
j=j+1
if(i<m-2*s || i > m+2*s){
x=x[-c(j)];
j=j-1;
}
}
interval=seq(0,10,1)
hist(x,breaks=interval,right=T,freq=T)
return(x)
}
remove_abberant("note_PS.csv",'P')
remove_abberant("note_PS.csv",'S')
source("F:/PS part2/tema2/tema2.R")
source("F:/PS part2/tema2/tema2.R")
source("F:/PS part2/tema2/tema2.R")
source("F:/PS part2/tema2/tema2.R")
source("F:/PS part2/tema2/tema2.R")
source("F:/PS part2/tema2/tema2.R")
setwd("F:/PS part2/lab3")
density_exp = function(lambda,a,n){
x=seq(0,a,n);
y=dexp(x,lambda);
plot(x,y,type=T)
}
density_exp(1,10,1)
density_exp = function(lambda,a,n){
x=seq(0,a,n);
y=dexp(x,lambda);
plot(x,y,type='l')
}
density_exp(1,10,1)
par(mfrow=c(1,1))
density_exp(1,10,1)
density_exp(1,10,100)
density_exp(1,10,1)
density_exp(1,10,100)
density_exp(1,100,1)
density_exp = function(lambda,a,n){
x=seq(0,a,length=n);
y=dexp(x,lambda);
plot(x,y,type='l')
}
density_exp(10,100,1)
density_exp(10,100,1000)
density_exp(0.1,100,1000)
density_exp(0.00001,100,1000)
density_exp(0.001,100,1000)
density_exp(0.01,100,1000)
density_exp(0.1,100,1000)
density_exp = function(lambda,a,n){
x=seq(0,a,length=n);
y=dexp(x,lambda);
plot(x,y,type='l')
}
density_gauss = function(m,sigma,a,n){
x=seq(m-a,m+a,length=n);
y=dnorm(x,m,sigma);
plot(x,y,type='l')
}
density_gauss(10,1,10,100)
density_gauss(10,2,10,100)
density_gauss(10,0.5,10,100)
density_gauss(10,0.5,100,100)
density_gauss(10,0.5,5,100)
density_gauss(10,0.5,5,300)
density_gauss(10,0.5,5,30)
density_gauss(10,0.5,5,3000)
density_gauss(10,0.5,5,300)
density_gauss(10,0.1,5,300)
density_gauss(10,3,5,300)
density_gauss(10,3,3,300)
density_gauss(10,2,5,300)
density_gauss(10,1,5,300)
density_gauss(10,1.5,5,300)
density_gauss = function(m,sigma,a,n){
x=seq(m-a,m+a,length=n);
y=dnorm(x,m,sigma);
plot(x,y,type='l')
}
density_gamma = function(shape, rate, a, n){
x=seq(0,a,length=n);
y=dgamma(x,shape, rate);
plot(x,y,type='l');
}
density_gamma(1,2,10,100)
density_gamma(2,1.3,10,100)
density_gamma(5,1.3,10,100)
density_gamma(2,1.3,10,100)
source("F:/PS part2/lab3/lab3.R")
density_student(10)
density_student(10,10,100)
density_student(10,10,100)
density_student = function(r,a,n){
x=seq(-a,a,length=n);
y=dt(x,r)
plot(x,y,type='l');
}
density_student(10,10,100)
density_student(1,10,100)
density_student(100,10,100)
density_student(1000,10,100)
density_student(180,10,100)
density_student(80,10,100)
density_student(80,100,100)
density_student(80,1,100)
density_student(40,10,100)
density_student(40,10,300)
LNM_Poisson = function(lambda,n){
sum=0;
for(i in 1:n){
u=rpois(i,lambda);
sum=sum+u;
}
print(sum/n)
}
lnm_poisson = function(lambda,n){
sum=0;
for(i in 1:n){
u=rpois(i,lambda);
sum=sum+u;
}
print(sum/n)
}
lnm_poisson(1,100)
lnm_poisson(1,10)
lnm_poisson = function(lambda,n){
sum=0;
for(i in 1:n){
sum=sum+rpois(i,lambda);
}
print(sum/n)
}
lnm_poisson(1,10)
lnm_poisson = function(lambda,n){
sum=0;
for(i in 1:n){
sum=sum+rpois(1,lambda);
}
print(sum/n)
}
lnm_poisson(1,10)
lnm_poisson(1,100)
lnm_poisson(1,10000)
lnm_poisson(1,10000000)
lnm_poisson(2,100000)
lnm_poisson(2,100000)
lnm_poisson(2,100000)
lnm_poisson(20,100000)
lnm_poisson(20,100000)
lnm_poisson(20,100000)
lnm_poisson(20,100000)
lnm_poisson(20,100000)
lnm_poisson(20,100000)
lnm_poisson(20,100000)
lnm_poisson(20,100000)
print(mean(rpois(n,lambda)))
lnm_poisson2 = function(lambda, n){
print(mean(rpois(n,lambda)))
}
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
lnm_poisson2(2,10000)
replicate(10,lnm_poisson2(2,1000))
mean(replicate(1000,lnm_poisson2(2,100000)))
mean(replicate(100,lnm_poisson2(2,10000)))
mean(replicate(100,lnm_poisson2(2,10000)))
mean(replicate(100,lnm_poisson2(2,10000)))
mean(replicate(100,lnm_poisson2(2,10000)))
mean(replicate(100,lnm_poisson2(2,10000)))
lnm_gamma = function(shape, rate, n){
print(mean(rgamma(n,shape,rate)))
}
mean(replicate(100,lnm_gamma(2,100000)))
mean(replicate(100,lnm_gamma(2,3,100000)))
mean(replicate(100,lnm_gamma(2,3,100000)))
mean(replicate(100,lnm_gamma(2,3,100000)))
mean(replicate(100,lnm_gamma(2,3,100000)))
mean(replicate(100,lnm_gamma(2,1.5,100000)))
mean(replicate(100,lnm_gamma(2,1.5,100000)))
lnm_student = function(r,n){
print(mean(rt(n,r)))
}
lnm_poisson2 = function(lambda, n){
print(mean(rpois(n,lambda)))
}
lnm_gamma = function(shape, rate, n){
print(shape/rate)
print(mean(rgamma(n,shape,rate)))
}
lnm_student = function(r,n){
print(mean(rt(n,r)))
}
mean(replicate(100,lnm_gamma(2,1.5,100000)))
mean(replicate(100,lnm_student(2,100000)))
mean(replicate(100,lnm_student(2,1000000)))
lnm_exp(lambda,n){
lnm_exp = function(lambda,n){
print(1/lambda);
print(mean(rexp(n,lambda)));
}
mean(replicate(100,lnm_exp(2,100000)))
lnm_exp = function(lambda,n){
m=1/lambda;
xn=mean(rexp(n,lambda));
print(abs(m-xn));
print(abs(m-xn)/abs(m))
print(xn);
}
lnm_student(2,1000000)
lnm_exp(2,1000000)
lnm_exp(2,1000000)
lnm_exp(2,1000000)
tlc_poisson = function(lambda, n, N, z) {
expectation = lambda;
st_dev = lambda;
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rpois(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
return(sum/N);
}
tlc_poisson(2,100,10,3)
tlc_poisson(2,100,100,3)
tlc_poisson(2,100,100,3)
tlc_poisson(2,100,100,3)
tlc_poisson(3,100,100,3)
tlc_poisson(3,100,100,3)
tlc_poisson(3,100,100,5)
tlc_poisson(3,100,100,100)
tlc_poisson(3,1000,100,1)
tlc_poisson(3,1000,10000,1)
tlc_poisson(3,100,10000,1)
tlc_poisson(2,100,10000,1)
tlc_poisson = function(lambda, n, N, z) {
expectation = lambda;
st_dev = sqrt(lambda);
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rpois(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
return(sum/N);
}
tlc_poisson(2,100,10000,1)
tlc_poisson(2,100,10000,32)
tlc_poisson(2,100,10000,3)
tlc_poisson = function(lambda, n, N, z) {
expectation = lambda;
st_dev = sqrt(lambda);
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rpois(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pnorm(z));
return(sum/N);
}
tlc_poisson(2,50,10000,3)
tlc_poisson(2,50,10000,0.6)
tlc_poisson(2,50,10000,1)
tlc_poisson(2,50,10000,1)
tlc_poisson(2,50,10000,1)
tlc_poisson(2,50,10000,1)
tlc_poisson(2,50,10000,1)
tlc_poisson(2,50,10000,1)
tlc_poisson(2,50,10000,1)
tlc_poisson(2,50,10000,1)
tlc_poisson(2,50,100000,1)
tlc_poisson(2,50,100000,1)
tlc_poisson(2,50,100000,1)
tlc_poisson(2,500,100000,1)
tlc_poisson(2,500,100000,1)
tlc_poisson(2,500,100000,0.6)
tlc_poisson(2,500,100000,0.06)
# media 1/lambda, disp 1/lambda patrat
tlc_exp = function(lambda,n,N,z){
expectation=1/lambda;
st_dev=1/(lambda*lambda);
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rpois(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pgeom(z));
return(sum/N);
}
tlc_exp(2,500,100000,0.06)
# media 1/lambda, disp 1/lambda patrat
tlc_exp = function(lambda,n,N,z){
expectation=1/lambda;
st_dev=1/(lambda*lambda);
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rpois(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pexp(z));
return(sum/N);
}
tlc_exp(2,500,100000,0.06)
tlc_exp(2,500,100000,1)
# media 1/lambda, disp 1/lambda patrat
tlc_exp = function(lambda,n,N,z){
expectation=1/lambda;
st_dev=1/(lambda);
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rpois(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pexp(z));
return(sum/N);
}
tlc_exp(2,500,100000,1)
tlc_poisson = function(lambda, n, N, z) {
expectation = lambda;
st_dev = sqrt(lambda);
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rpois(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pnorm(z));
return(sum/N);
}
# media 1/lambda, disp 1/lambda patrat
tlc_exp = function(lambda,n,N,z){
expectation=1/lambda;
st_dev=1/lambda;
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rpois(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pexp(z));
return(sum/N);
}
tlc_exp(3,40,100000,2)
# media 1/lambda, disp 1/lambda patrat
tlc_exp = function(lambda,n,N,z){
expectation=1/lambda;
st_dev=1/lambda;
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rexp(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pexp(z));
return(sum/N);
}
tlc_exp(3,40,100000,2)
tlc_exp(3,40,100000,2)
tlc_exp(3,400,100000,2)
tlc_gamma = function(shape,rate,n,N,z){
expectation=shape/rate;
st_dev=sqrt(shape)/rate;
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rgamma(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pgamma(z));
return(sum/N);
}
tlc_gamma(3,400,100000,2)
tlc_gamma(3,5,400,100000,2)
tlc_gamma(3,5,200,100000,2)
tlc_gamma = function(shape,rate,n,N,z){
expectation=shape/rate;
st_dev=sqrt(shape)/rate;
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rgamma(n, lambda));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pgamma(z,shape,rate));
return(sum/N);
}
tlc_gamma(3,5,200,100000,2)
tlc_gamma = function(shape,rate,n,N,z){
expectation=shape/rate;
st_dev=sqrt(shape)/rate;
upper_bound = z * st_dev/sqrt(n) + expectation;
sum = 0;
for(i in 1:N) {
x_n = mean(rgamma(n, shape,rate));
if(x_n <= upper_bound) {
sum = sum + 1;
}
}
print(pgamma(z,shape,rate));
return(sum/N);
}
tlc_gamma(3,5,200,100000,2)
dml = function(n,p,k){
expectation=n*p;
st_dev=sqrt(n*p*(1-p));
xd=(k+0.5-expectation)/st_dev;
xs=(k-0.5-expectation)/st_dev;
print(pnorm(xd)-pnorm(xs))
}
dml = function(n,p,k){
expectation=n*p;
st_dev=sqrt(n*p*(1-p));
xd=(k+0.5-expectation)/st_dev;
xs=(k-0.5-expectation)/st_dev;
print(pnorm(xd)-pnorm(xs));
print(dbinom(k,n,p));
}
dml(100,0.5,5)
dml(100,1,5)
dml(100,0.2,5)
dml(30,0.2,5)
dml(30,0.2,20)
dml(30,0.2,10)
dml(30,0.3,10)
dml(30,0.3,15)
dml(30,0.2,15)
dml(30,0.2,30)
dml(30,0.2,10)
dml_1 = function(n,p,k1,k2){
expectation=n*p;
st_dev=sqrt(n*p*(1-p));
xd=(k2+0.5-expectation)/st_dev;
xs=(k1-0.5-expectation)/st_dev;
print(pnorm(xd)-pnorm(xs));
print(dbinom(k,n,p));
}
dml_1(30,0.2,10,15)
dml_1 = function(n,p,k1,k2){
expectation=n*p;
st_dev=sqrt(n*p*(1-p));
xd=(k2+0.5-expectation)/st_dev;
xs=(k1-0.5-expectation)/st_dev;
print(pnorm(xd)-pnorm(xs));
print(dbinom(k1:k2,n,p));
}
dml_1(30,0.2,10,15)
dml_1 = function(n,p,k1,k2){
expectation=n*p;
st_dev=sqrt(n*p*(1-p));
xd=(k2+0.5-expectation)/st_dev;
xs=(k1-0.5-expectation)/st_dev;
print(pnorm(xd)-pnorm(xs));
print(sum(dbinom(k1:k2,n,p)));
}
dml_1(30,0.2,10,15)
dml_1(30,0.2,10,15)
dml_1(30,0.2,10,15)
dml_1(30,0.2,10,15)
dml_1(30,0.2,10,20)
dml_1(30,0.2,5,20)
dml_1(25,0.7,10,20)
source("F:/PS part2/tema2/tema2.R")
setwd("F:/PS part2/tema2")
source("F:/PS part2/tema2/tema2.R")
source("F:/PS part2/lab4/main.r")
source("F:/PS part2/lab4/main.r")
source("F:/PS part2/lab4/main.r")
source("F:/PS part2/lab4/main.r")
MC_improved_integration_2(10000,1)
MC_improved_integration_2(10000,2)
source("F:/PS part2/lab4/tema.r")
